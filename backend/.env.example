# backend/.env.example
# ============================================================================
# THREE-TIER DATABASE SAFETY SYSTEM
# ============================================================================
# We use three separate databases for maximum safety:
#
# 1. INT (Integration Test DB) - Default, no flags needed
#    - Used ONLY for pytest
#    - Can be freely dropped and rebuilt
#    - Example: instainstru_test
#
# 2. STG (Staging/Local Dev DB) - Requires USE_STG_DATABASE=true
#    - Used for localhost development
#    - Preserves data between test runs
#    - Example: instainstru_stg
#
# 3. PROD (Production DB) - Requires USE_PROD_DATABASE=true + confirmation
#    - Your actual production database
#    - Requires interactive "yes" confirmation
#    - Should point to Supabase or other cloud provider
# ============================================================================

# Production Database Configuration (PROD)
# This is your real production database - BE CAREFUL!
database_url=postgresql://username:password@localhost:5432/instainstru

# Staging/Local Development Database (STG)
# Used for local development to preserve data between test runs
stg_database_url=postgresql://username:password@localhost:5432/instainstru_stg

# Integration Test Database (INT)
# Used ONLY for pytest - will be dropped/reset frequently
test_database_url=postgresql://username:password@localhost:5432/instainstru_test

# Security
secret_key=your-secret-key-here
algorithm=HS256
access_token_expire_minutes=30

# Email Service
resend_api_key=your-resend-api-key
from_email=InstaInstru <hello@instainstru.com>
admin_email=admin@instainstru.com  # Email for critical monitoring alerts

# Frontend Configuration
ALLOWED_ORIGINS=http://localhost:3000,http://beta-local.instainstru.com:3000
# Preview/Beta/Prod should override with public domains (wildcards like * are
# incompatible with allow_credentials=true). Legacy envs CORS_ALLOW_ORIGINS /
# CORS_ALLOWED_ORIGINS are still honoured but should be migrated to
# ALLOWED_ORIGINS.
frontend_url=http://localhost:3000

# Environment
environment=development

# Dev/Stage defaults
# Ensure referral issuance stays enabled in dev/stage unless explicitly overridden.
REFERRALS_UNSAFE_STEP=4

# Cache Configuration
redis_url=redis://localhost:6379
cache_ttl=3600

# Supabase (if using for production)
supabase_url=your-supabase-url
supabase_anon_key=your-supabase-anon-key

# Stripe Payment Configuration
stripe_publishable_key=pk_test_your_stripe_publishable_key_here
stripe_secret_key=sk_test_your_stripe_secret_key_here

# Webhook secrets - Different configurations for local vs deployed environments
# For local development with Stripe CLI (single secret):
stripe_webhook_secret=whsec_your_webhook_endpoint_secret_here

# For deployed environments with separate platform and connect webhooks:
# stripe_webhook_secret_platform=whsec_platform_events_secret_here
# stripe_webhook_secret_connect=whsec_connect_events_secret_here

stripe_platform_fee_percentage=15  # 15% platform fee
stripe_currency=usd


# Public API Configuration
public_availability_days=7  # Show only next 7 days
public_availability_detail_level=full  # Options: full, summary, minimal
public_availability_show_instructor_name=true
public_availability_cache_ttl=300  # 5 minutes

# Availability guardrails (bitmap path)
# For production/staging deployments:
#   PAST_EDIT_WINDOW_DAYS=30
#   CLAMP_COPY_TO_FUTURE=true
#   SUPPRESS_PAST_AVAILABILITY_EVENTS=true
# Local/testing defaults can relax restrictions (0/false/false).
PAST_EDIT_WINDOW_DAYS=0
CLAMP_COPY_TO_FUTURE=false
SUPPRESS_PAST_AVAILABILITY_EVENTS=false

# Different configurations for different use cases:

# For MVP/Testing - Show everything
# public_availability_days=30
# public_availability_detail_level=full

# For Privacy-Focused - Limited info
# public_availability_days=3
# public_availability_detail_level=minimal

# For Teaser/Marketing - Show some info
# public_availability_days=7
# public_availability_detail_level=summary

# ============================================================================
# LOCAL TEST DATABASE SETUP
# ============================================================================
# To create a local test database:
#
# 1. Connect to PostgreSQL:
#    psql -U postgres
#
# 2. Create test database:
#    CREATE DATABASE instainstru_test;
#
# 3. Set test_database_url:
#    test_database_url=postgresql://postgres:yourpassword@localhost:5432/instainstru_test
#
# IMPORTANT: Never point test_database_url to your production database!
# ============================================================================
